<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <title>后台管理</title>

  <link href="/assets/app_photo.css?body=1" media="screen" rel="stylesheet" type="text/css" />
<link href="/assets/application.css?body=1" media="screen" rel="stylesheet" type="text/css" />
  <link href="/ext-4.1.1a/resources/css/ext-all.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/ext-4.1.1a/ext-all.js" type="text/javascript"></script>  <script src="/ext-4.1.1a/examples/ux/CheckColumn.js" type="text/javascript"></script>  <script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/common.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script>

  <script type="text/javascript">
    Ext.onReady(function() {

      Ext.QuickTips.init();

      //如果未登录
      var topPanel = new Ext.Panel({
        bbar: ['<b style="font-size:14px;">后台管理---欢迎您，请进行登录</b>', '->',{
            text: '<img src="assets/system/user_go.png"/><font style="font-size:13px;">登录系统</font>',
            scope: this,
            handler: function() {
              Ext.Ajax.request({
                url : 'index/login',
                success : function (result, request) {
                  window.document.location.href = 'index/admin';
                },
                failure : function (result, request){
                  Ext.MessageBox.alert("提示","通讯失败，请从新操作");
                },
                method : 'POST'
              });
            }
          }],
        cls:'empty',
        region:'north'
      });

      //中央工作区
      var workTabs = new Ext.tab.Panel({
        region:'center',
        margins:'5 5 5 0',
        activeTab: 0,
        enableTabScroll:true,
        defaults: {autoScroll:true}
      });

      var south = new Ext.Component({
        region: 'south',
        margins:'5 0 0 5',
        height: 22,
        autoEl: {
          tag: 'div',
          html:'<div style="font-size:12px;text-algin:center;"><center>&nbsp&nbsp&nbsp</center></div>'
        }
      })

      //系统提醒，Panel
      var reminderPanel = new Ext.Panel({
        title: '欢迎页面',
        id:'reminder_panel',
        defaults:{margins:'5 5 5 5'},
        listeners: {
        }
      });

      workTabs.add(reminderPanel).show();

      //左边的菜单栏
      var accordition = new Ext.Panel({
        region:'west',
        margins:'5 0 5 5',
        split:true,
        width: 140,
        layout:'accordion'
      });

      var menus = eval([{"id":1,"name":"\u7f51\u7ad9\u529f\u80fd\u5217\u8868","image":"assets/system/bricks.png","url":"#","qtip":"\u7f51\u7ad9\u529f\u80fd\u5217\u8868","leaf":true,"children":[{"id":10,"name":"\u7cfb\u5217","image":"assets/system/user_red.png","hrefTarget":"dimensions","qtip":"\u7cfb\u5217","leaf":true},{"id":13,"name":"\u5e74\u4ee3","image":"assets/system/group_gear.png","hrefTarget":"periods","qtip":"\u5e74\u4ee3","leaf":true},{"id":11,"name":"gundam","image":"assets/system/user_red.png","hrefTarget":"gundams","qtip":"gundam","leaf":true},{"id":12,"name":"\u9a7e\u9a76\u5458","image":"assets/system/group_gear.png","hrefTarget":"drivers","qtip":"\u9a7e\u9a76\u5458","leaf":true},{"id":14,"name":"\u673a\u4f53\u7c7b\u578b","image":"assets/system/group_gear.png","hrefTarget":"types","qtip":"\u673a\u4f53\u7c7b\u578b","leaf":true}]},{"id":2,"name":"\u7f51\u7ad9\u7528\u6237\u7ba1\u7406","image":"assets/system/group_gear.png","url":"#","qtip":"\u7f51\u7ad9\u7528\u6237\u7ba1\u7406","leaf":true,"children":[{"id":21,"name":"\u7f51\u7ad9\u7528\u6237\u7ba1\u7406","image":"assets/system/group_gear.png","url":"users","qtip":"\u7f51\u7ad9\u7528\u6237\u7ba1\u7406","leaf":true}]}]);
      if (!menus) { return; }
      for (var i = 0; i < menus.length; i++) {
        var item = menus[i];

        var title = "<div style='background:url(" + item.image +
          ") no-repeat;padding-left:20px;'>" +
          item.name +
          "</div>";
        for (var j = 0; j < item.children.length; j++) {
          var o = item.children[j];
          o.text = o.name;
          o.icon = o.image;
        }
        var node = new Ext.tree.TreePanel({
          title: title,
          rootVisible: false,
          lines: false,
          autoScroll: true,
          qtips: item.qitps,
          root: {
            editable: false,
            expanded: true,
            text: item.name,
            draggable: false,
            children: item.children
          },
          listeners: {
            itemclick: function(view,re) {
              if(Ext.getCmp('tab'+re.data.id)){
                dynamicPanel = Ext.getCmp('tab'+re.data.id)
              }else{
                var dynamicPanel = new Ext.Component({
                  title: re.data.text,
                  id: 'tab'+re.data.id,
                  closable: true,
                  loader: {
                    url: re.data.hrefTarget,
                    contentType: 'html',
                    scripts: true
                  },
                  listeners: {
                    activate: function(tab) {
                      tab.loader.load();
                    }
                  }
                });
                workTabs.add(dynamicPanel);
              }
              workTabs.setActiveTab(dynamicPanel);
            }
          }
        });
        accordition.add(node);
      }

      new Ext.Viewport({
        layout:'border',
        items:[topPanel,accordition,workTabs,south]
      });
    });
  </script>

  </head>
  <body>
    <div id="index_index_div" style="width:100%; height:100%"></div>
  </body>
</html>